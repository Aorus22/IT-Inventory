import exceljs from "exceljs"
import {Item, PurchaseOrder} from "@prisma/client";

function base64ToArrayBuffer(base64: string) {
  const byteCharacters = atob(base64);
  const byteNumbers = new Array(byteCharacters.length);
  for (let i = 0; i < byteCharacters.length; i++) {
    byteNumbers[i] = byteCharacters.charCodeAt(i);
  }
  const byteArray = new Uint8Array(byteNumbers);
  return new Blob([byteArray], {type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});
}

export const saveFile = (buffer: exceljs.Buffer) => {
  let blob = new Blob([buffer], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
  let link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = "fName.xlsx";
  link.click();
  URL.revokeObjectURL(link.href);
}

const EXCEL = "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"
const excelPO = async (dataPO: PurchaseOrder, dataItem: Item) => {
  const wb = new exceljs.Workbook()
  const reader = new FileReader();
  reader.readAsArrayBuffer(base64ToArrayBuffer(EXCEL))
  const a = () => new Promise((resolve) => {
    reader.onload = () => {
      const buffer = reader.result! as ArrayBuffer;
      wb.xlsx.load(buffer).then(workbook => {
        resolve(true)
      })
    }
  })
  await a()
  const ws = wb.getWorksheet("Form Po")!
  ws.getCell("D7").value = dataPO.nama_pemesan
  ws.getCell("C14").value = dataItem.nama_item
  ws.getCell("D14").value = dataPO.deskripsi
  ws.getCell("E14").value = dataPO.tanggal
  ws.getCell("F14").value = dataPO.kuantitas
  ws.getCell("J14").value = dataItem.harga
  ws.getCell("K14").value = dataPO.kuantitas*dataItem.harga
  const buff = await wb.xlsx.writeBuffer()
  saveFile(buff)
}

export default excelPO

// import exceljs from "exceljs"
// import {Item, PurchaseOrder} from "@prisma/client";
//
// const excelPO = async (dataPO: PurchaseOrder, dataItem: Item) => {
//   const wb = await new exceljs.Workbook().xlsx.readFile("./util/Form PO.xlsx")
//   const ws = wb.getWorksheet("Form Po")!
//   ws.getCell("D7").value = dataPO.nama_pemesan
//   ws.getCell("C14").value = dataItem.nama_item
//   ws.getCell("D14").value = dataPO.deskripsi
//   ws.getCell("E14").value = dataPO.tanggal.toString()
//   ws.getCell("F14").value = dataItem.harga
//   ws.getCell("J14").value = dataPO.kuantitas
//   ws.getCell("K14").value = dataPO.kuantitas*dataItem.harga
//   return wb.xlsx.writeFile("resul2t.xlsx")
// }
//
// export default excelPO